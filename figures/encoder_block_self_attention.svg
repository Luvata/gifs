<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.46.0 (0)
 -->
<!-- Pages: 1 -->
<svg width="1174pt" height="718pt"
 viewBox="0.00 0.00 1174.04 718.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 714)">
<polygon fill="white" stroke="transparent" points="-4,4 -4,-714 1170.04,-714 1170.04,4 -4,4"/>
<text text-anchor="middle" x="583.02" y="-694.8" font-family="Times,serif" font-size="14.00">EncoderBlock</text>
<g id="clust1" class="cluster">
<title>cluster_.7</title>
<polygon fill="none" stroke="black" points="8,-136 8,-643 1032,-643 1032,-136 8,-136"/>
<text text-anchor="middle" x="520" y="-627.8" font-family="Times,serif" font-size="14.00">self_attention (AttentionAddNorm)</text>
</g>
<!-- inp_1 -->
<g id="node1" class="node">
<title>inp_1</title>
<ellipse fill="none" stroke="black" cx="493" cy="-669" rx="36" ry="18"/>
<text text-anchor="middle" x="493" y="-665.3" font-family="Times,serif" font-size="14.00">inp_1</text>
</g>
<!-- self_attention.inp_1 -->
<g id="node3" class="node">
<title>self_attention.inp_1</title>
<ellipse fill="none" stroke="black" cx="493" cy="-594" rx="102.08" ry="18"/>
<text text-anchor="middle" x="493" y="-590.3" font-family="Times,serif" font-size="14.00">self_attention.inp_1</text>
</g>
<!-- inp_1&#45;&gt;self_attention.inp_1 -->
<g id="edge1" class="edge">
<title>inp_1&#45;&gt;self_attention.inp_1</title>
<path fill="none" stroke="black" d="M493,-650.7C493,-642.25 493,-631.87 493,-622.37"/>
<polygon fill="black" stroke="black" points="496.5,-622.18 493,-612.18 489.5,-622.18 496.5,-622.18"/>
</g>
<!-- inp_mask.1 -->
<g id="node2" class="node">
<title>inp_mask.1</title>
<ellipse fill="none" stroke="black" cx="1103" cy="-594" rx="63.09" ry="18"/>
<text text-anchor="middle" x="1103" y="-590.3" font-family="Times,serif" font-size="14.00">inp_mask.1</text>
</g>
<!-- self_attention.inp_mask.1 -->
<g id="node4" class="node">
<title>self_attention.inp_mask.1</title>
<ellipse fill="none" stroke="black" cx="895" cy="-522" rx="129.18" ry="18"/>
<text text-anchor="middle" x="895" y="-518.3" font-family="Times,serif" font-size="14.00">self_attention.inp_mask.1</text>
</g>
<!-- inp_mask.1&#45;&gt;self_attention.inp_mask.1 -->
<g id="edge2" class="edge">
<title>inp_mask.1&#45;&gt;self_attention.inp_mask.1</title>
<path fill="none" stroke="black" d="M1063.88,-579.83C1032.25,-569.19 987.3,-554.06 951.73,-542.09"/>
<polygon fill="black" stroke="black" points="952.55,-538.68 941.96,-538.8 950.32,-545.31 952.55,-538.68"/>
</g>
<!-- self_attention..215 -->
<g id="node5" class="node">
<title>self_attention..215</title>
<polygon fill="none" stroke="black" points="484,-540 258,-540 258,-504 484,-504 484,-540"/>
<text text-anchor="middle" x="371" y="-518.3" font-family="Times,serif" font-size="14.00">self_attention.Q_proj (Linear)</text>
</g>
<!-- self_attention.inp_1&#45;&gt;self_attention..215 -->
<g id="edge3" class="edge">
<title>self_attention.inp_1&#45;&gt;self_attention..215</title>
<path fill="none" stroke="black" d="M464.4,-576.59C448.08,-567.23 427.42,-555.37 409.67,-545.19"/>
<polygon fill="black" stroke="black" points="411.11,-541.98 400.7,-540.04 407.63,-548.05 411.11,-541.98"/>
</g>
<!-- self_attention..216 -->
<g id="node6" class="node">
<title>self_attention..216</title>
<polygon fill="none" stroke="black" points="727.5,-540 502.5,-540 502.5,-504 727.5,-504 727.5,-540"/>
<text text-anchor="middle" x="615" y="-518.3" font-family="Times,serif" font-size="14.00">self_attention.K_proj (Linear)</text>
</g>
<!-- self_attention.inp_1&#45;&gt;self_attention..216 -->
<g id="edge4" class="edge">
<title>self_attention.inp_1&#45;&gt;self_attention..216</title>
<path fill="none" stroke="black" d="M521.6,-576.59C537.92,-567.23 558.58,-555.37 576.33,-545.19"/>
<polygon fill="black" stroke="black" points="578.37,-548.05 585.3,-540.04 574.89,-541.98 578.37,-548.05"/>
</g>
<!-- self_attention..217 -->
<g id="node7" class="node">
<title>self_attention..217</title>
<polygon fill="none" stroke="black" points="240,-540 16,-540 16,-504 240,-504 240,-540"/>
<text text-anchor="middle" x="128" y="-518.3" font-family="Times,serif" font-size="14.00">self_attention.V_proj (Linear)</text>
</g>
<!-- self_attention.inp_1&#45;&gt;self_attention..217 -->
<g id="edge5" class="edge">
<title>self_attention.inp_1&#45;&gt;self_attention..217</title>
<path fill="none" stroke="black" d="M426.48,-580.24C370.66,-569.54 290.12,-554.09 226.76,-541.94"/>
<polygon fill="black" stroke="black" points="227.23,-538.47 216.75,-540.02 225.91,-545.34 227.23,-538.47"/>
</g>
<!-- self_attention.input.6 -->
<g id="node11" class="node">
<title>self_attention.input.6</title>
<path fill="none" stroke="black" d="M690,-324C690,-324 660,-324 660,-324 654,-324 648,-318 648,-312 648,-312 648,-300 648,-300 648,-294 654,-288 660,-288 660,-288 690,-288 690,-288 696,-288 702,-294 702,-300 702,-300 702,-312 702,-312 702,-318 696,-324 690,-324"/>
<text text-anchor="middle" x="675" y="-302.3" font-family="Times,serif" font-size="14.00">add</text>
</g>
<!-- self_attention.inp_1&#45;&gt;self_attention.input.6 -->
<g id="edge12" class="edge">
<title>self_attention.inp_1&#45;&gt;self_attention.input.6</title>
<path fill="none" stroke="black" d="M581.82,-585.11C642.93,-577.64 716.47,-563.91 736,-540 761.32,-509.01 748.33,-396.07 731,-360 725.71,-348.99 717.07,-339.09 708.15,-330.92"/>
<polygon fill="black" stroke="black" points="710.18,-328.05 700.31,-324.19 705.62,-333.36 710.18,-328.05"/>
</g>
<!-- self_attention.input.5 -->
<g id="node9" class="node">
<title>self_attention.input.5</title>
<path fill="none" stroke="black" d="M716,-468C716,-468 468,-468 468,-468 462,-468 456,-462 456,-456 456,-456 456,-444 456,-444 456,-438 462,-432 468,-432 468,-432 716,-432 716,-432 722,-432 728,-438 728,-444 728,-444 728,-456 728,-456 728,-462 722,-468 716,-468"/>
<text text-anchor="middle" x="592" y="-446.3" font-family="Times,serif" font-size="14.00">pow softmax matmul masked_filldiv</text>
</g>
<!-- self_attention.inp_mask.1&#45;&gt;self_attention.input.5 -->
<g id="edge6" class="edge">
<title>self_attention.inp_mask.1&#45;&gt;self_attention.input.5</title>
<path fill="none" stroke="black" d="M831.11,-506.24C785.87,-495.79 724.76,-481.67 675.64,-470.32"/>
<polygon fill="black" stroke="black" points="676.19,-466.86 665.66,-468.02 674.62,-473.68 676.19,-466.86"/>
</g>
<!-- self_attention..215&#45;&gt;self_attention.input.5 -->
<g id="edge9" class="edge">
<title>self_attention..215&#45;&gt;self_attention.input.5</title>
<path fill="none" stroke="black" d="M424.78,-503.97C455.93,-494.1 495.32,-481.62 528.05,-471.25"/>
<polygon fill="black" stroke="black" points="529.5,-474.47 537.98,-468.11 527.39,-467.79 529.5,-474.47"/>
</g>
<!-- self_attention..216&#45;&gt;self_attention.input.5 -->
<g id="edge8" class="edge">
<title>self_attention..216&#45;&gt;self_attention.input.5</title>
<path fill="none" stroke="black" d="M609.31,-503.7C606.75,-495.9 603.67,-486.51 600.82,-477.83"/>
<polygon fill="black" stroke="black" points="604.07,-476.51 597.62,-468.1 597.42,-478.7 604.07,-476.51"/>
</g>
<!-- self_attention..217&#45;&gt;self_attention.input.5 -->
<g id="edge7" class="edge">
<title>self_attention..217&#45;&gt;self_attention.input.5</title>
<path fill="none" stroke="black" d="M240.03,-504.1C309.18,-493.67 397.96,-480.27 469.05,-469.55"/>
<polygon fill="black" stroke="black" points="469.6,-473.01 478.96,-468.05 468.55,-466.08 469.6,-473.01"/>
</g>
<!-- self_attention..218 -->
<g id="node8" class="node">
<title>self_attention..218</title>
<polygon fill="none" stroke="black" points="722,-396 474,-396 474,-360 722,-360 722,-396"/>
<text text-anchor="middle" x="598" y="-374.3" font-family="Times,serif" font-size="14.00">self_attention.dropout (Dropout)</text>
</g>
<!-- self_attention..218&#45;&gt;self_attention.input.6 -->
<g id="edge11" class="edge">
<title>self_attention..218&#45;&gt;self_attention.input.6</title>
<path fill="none" stroke="black" d="M617.03,-359.7C626.54,-351.05 638.21,-340.45 648.57,-331.03"/>
<polygon fill="black" stroke="black" points="651.14,-333.42 656.19,-324.1 646.43,-328.24 651.14,-333.42"/>
</g>
<!-- self_attention.input.5&#45;&gt;self_attention..218 -->
<g id="edge10" class="edge">
<title>self_attention.input.5&#45;&gt;self_attention..218</title>
<path fill="none" stroke="black" d="M593.48,-431.7C594.14,-423.98 594.94,-414.71 595.68,-406.11"/>
<polygon fill="black" stroke="black" points="599.17,-406.37 596.53,-396.1 592.19,-405.77 599.17,-406.37"/>
</g>
<!-- self_attention..219 -->
<g id="node10" class="node">
<title>self_attention..219</title>
<polygon fill="none" stroke="black" points="822.5,-252 527.5,-252 527.5,-216 822.5,-216 822.5,-252"/>
<text text-anchor="middle" x="675" y="-230.3" font-family="Times,serif" font-size="14.00">self_attention.layer_norm (LayerNorm)</text>
</g>
<!-- self_attention.out_0 -->
<g id="node12" class="node">
<title>self_attention.out_0</title>
<ellipse fill="none" stroke="black" cx="675" cy="-162" rx="102.88" ry="18"/>
<text text-anchor="middle" x="675" y="-158.3" font-family="Times,serif" font-size="14.00">self_attention.out_0</text>
</g>
<!-- self_attention..219&#45;&gt;self_attention.out_0 -->
<g id="edge14" class="edge">
<title>self_attention..219&#45;&gt;self_attention.out_0</title>
<path fill="none" stroke="black" d="M675,-215.7C675,-207.98 675,-198.71 675,-190.11"/>
<polygon fill="black" stroke="black" points="678.5,-190.1 675,-180.1 671.5,-190.1 678.5,-190.1"/>
</g>
<!-- self_attention.input.6&#45;&gt;self_attention..219 -->
<g id="edge13" class="edge">
<title>self_attention.input.6&#45;&gt;self_attention..219</title>
<path fill="none" stroke="black" d="M675,-287.7C675,-279.98 675,-270.71 675,-262.11"/>
<polygon fill="black" stroke="black" points="678.5,-262.1 675,-252.1 671.5,-262.1 678.5,-262.1"/>
</g>
<!-- .8 -->
<g id="node13" class="node">
<title>.8</title>
<polygon fill="none" stroke="black" points="819,-108 531,-108 531,-72 819,-72 819,-108"/>
<text text-anchor="middle" x="675" y="-86.3" font-family="Times,serif" font-size="14.00">feed_forward (FeedForwardAddNorm)</text>
</g>
<!-- self_attention.out_0&#45;&gt;.8 -->
<g id="edge15" class="edge">
<title>self_attention.out_0&#45;&gt;.8</title>
<path fill="none" stroke="black" d="M675,-143.7C675,-135.98 675,-126.71 675,-118.11"/>
<polygon fill="black" stroke="black" points="678.5,-118.1 675,-108.1 671.5,-118.1 678.5,-118.1"/>
</g>
<!-- out_0 -->
<g id="node14" class="node">
<title>out_0</title>
<ellipse fill="none" stroke="black" cx="675" cy="-18" rx="36.29" ry="18"/>
<text text-anchor="middle" x="675" y="-14.3" font-family="Times,serif" font-size="14.00">out_0</text>
</g>
<!-- .8&#45;&gt;out_0 -->
<g id="edge16" class="edge">
<title>.8&#45;&gt;out_0</title>
<path fill="none" stroke="black" d="M675,-71.7C675,-63.98 675,-54.71 675,-46.11"/>
<polygon fill="black" stroke="black" points="678.5,-46.1 675,-36.1 671.5,-46.1 678.5,-46.1"/>
</g>
</g>
</svg>
